{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Faculty Attendance</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

<nav class="bg-indigo-900 text-white p-4 flex justify-between">
  <h1 class="text-xl font-bold">Attendance Management</h1>
  <a href="{% url 'faculty_dashboard' %}" class="hover:underline">Dashboard</a>
</nav>

<div class="max-w-6xl mx-auto mt-6 bg-white p-6 rounded shadow">

  <h2 class="text-2xl font-semibold mb-4">Mark Attendance</h2>

  <!-- Course and Date Selection -->
  <form method="get" class="flex gap-4 mb-6">
    <select name="course" class="border p-2 rounded" required>
      <option value="">Select Course</option>
      {% for course in courses %}
        <option value="{{ course.id }}" {% if course.id|stringformat:"s" == selected_course_id %}selected{% endif %}>
          {{ course.code }} - {{ course.name }}
        </option>
      {% endfor %}
    </select>

    <input type="date" name="date" value="{{ selected_date }}" class="border p-2 rounded" required>

    <button type="submit" class="bg-indigo-700 text-white px-4 py-2 rounded hover:bg-indigo-800">Load</button>
  </form>

  {% if students %}
  <form method="post">
    {% csrf_token %}
    <table class="w-full border text-left">
      <thead class="bg-gray-100">
        <tr>
          <th class="p-2 border">Student Name</th>
          <th class="p-2 border">Roll No</th>
          <th class="p-2 border">Status</th>
        </tr>
      </thead>
      <tbody>
        {% for student in students %}
        <tr class="hover:bg-gray-50">
          <td class="p-2 border">{{ student.user.get_full_name|default:student.user.username }}</td>
          <td class="p-2 border">{{ student.roll_no }}</td>
          <td class="p-2 border">
            <select name="status_{{ student.id }}" class="border p-1 rounded">
              <option value="Present" {% if attendance_records.student.id == student.id and attendance_records.student.id == "Present" %}selected{% endif %}>Present</option>
              <option value="Absent" {% if attendance_records.student.id == student.id and attendance_records.student.id == "Absent" %}selected{% endif %}>Absent</option>
            </select>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <button type="submit" class="mt-4 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
      Save Attendance
    </button>
  </form>
  {% else %}
    <p class="text-gray-500 mt-4">Select a course and date to mark attendance.</p>
  {% endif %}

</div>

</body>
</html>
